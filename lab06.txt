1

SELECT rodzaj, avg(waga) from kreatura WHERE rodzaj='wiking' group by rodzaj;


SELECT rodzaj, avg(waga), count(rodzaj) from kreatura group by rodzaj;

SELECT rodzaj, avg(dataUr) FROM kreatura group by rodzaj;

SELECT avg(2021-year(dataUr)), rodzaj FROM kreatura group by rodzaj;



2

SELECT rodzaj, SUM(waga*ilosc) FROM zasob group by rodzaj;


SELECT nazwa, AVG(waga)
from zasob where ilosc>=4
group by nazwa having AVG(waga) > 10;


SELECT COUNT(DISTINCT nazwa), rodzaj FROM zasob WHERE ilosc>1 GROUP by rodzaj;



3

\\select * from kreatura, ekwipunek where kreatura.idKreatury = \\ekwipunek.idKreatury;
\\select * from kreatura k inner join ekwipunek e on k.idKreatury =        \\e.idKreatury;

select kreatura.nazwa, count(ilosc) from kreatura inner join ekwipunek on kreatura.idKreatury = ekwipunek.idKreatury group by nazwa;

select kreatura.nazwa, zasob.nazwa from kreatura, ekwipunek, zasob where kreatura.idKreatury = ekwipunek.idKreatury and ekwipunek.idZasobu = zasob.idZasobu order by kreatura.nazwa;

\\1 mozliwosc
select kreatura.nazwa, kreatura.idKreatury from kreatura left join ekwipunek on kreatura.idKreatury = ekwipunek.idKreatury where ekwipunek.idKreatury is null;
\\2 mozliwosc
select nazwa, idKreatury from kreatura where idKreatury not in(select idKreatury from ekwipunek where idKreatury is not null);

4

select distinct(kreatura.nazwa), zasob.nazwa, dataUr from kreatura natural join ekwipunek, zasob where dataUr between '1670-01-01' and '1679-12-31';

select k.nazwa, z.rodzaj from kreatura k, ekwipunek e, zasob z where k.idKreatury = e.idKreatury and e.idZasobu = z.idZasobu and z.rodzaj = 'jedzenie' limit 5;

select k1.nazwa, k2.nazwa from kreatura k1, kreatura k2 where k2.idKreatury = k1.idKreatury+5;


5
SELECT ekwipunek.idKreatury, SUM(ekwipunek.ilosc)  FROM kreatura
INNER JOIN ekwipunek
ON kreatura.idKreatury=ekwipunek.idEkwipunku GROUP BY ekwipunek.idKreatury;

select k.rodzaj,sum(e.ilosc), avg(e.ilosc * z.waga) 
from kreatura k 
inner join ekwipunek e on k.idKreatury = e.idKreatury 
inner join zasob z on e.idZasobu = z.idZasobu 
where k.rodzaj not in('malpa','waz') 
group by k.rodzaj having sum(e.ilosc)<30;

select min(dataUr), rodzaj from kreatura group by rodzaj;


select year(dataUr), month(dataUr), group_concat(nazwa) from kreatura group by 1,2 order by 1;



select nazwa, rodzaj, dataUr from kreatura where dataUr in(
select min(dataUr) from kreatura
group by rodzaj) or
dataUr in (
select max(dataUr) from kreatura
group by rodzaj);









